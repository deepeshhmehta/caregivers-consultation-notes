<ion-view class="rjoin-view" >
    <ion-nav-title>
        <span> {{user.fname}} {{user.lname}}</span>
    </ion-nav-title>
    <ion-nav-buttons side="right">
        <button class="button button-icon button-clear" ng-click="exitVideo()"> Exit</button>
    </ion-nav-buttons>
    <div class="bar bar-subheader cbar" >
        <div class="row">
            <div class="col txt-left"><h5> {{appDetails[0].appointments.scheduled_start_time|time1}}</h5></div>
            <div class="col txt-right"><h5> {{result}}</h5></div>
            <!--  <div class="addnebtn btn-share ion-medkit" ng-click="inventory();"></div> -->
            <!--<div class="addnebtn btn-add ion-plus" ng-click="addnote();"></div>-->
        </div>
    </div>
    <ion-content>
        <div class="mediascreen mdhight">
            <!--<iframe class="videochat" ng-src="{{trustSrc(oToken)}}" ></iframe>-->
            <div id='myPublisherDiv' style="position:absolute;right: 10px;bottom:10px"></div> 
            <div id='subscribersDiv' class="subscribediv">Waiting for patient to join!</div> 
        </div>
        
        <!-- background -->
        <div class="crighttab greentab" id="cstab1">
            <div class="ctabbtn" ng-click="pulltab('cstab1')">
                <span class="ion-person"></span>
            </div>
            <div class="sidetabcontent">
                <ion-scroll direction="y" class="theroot"> 
                   
                    <div class="clr"></div><div class="clr"></div>
                    <div class="sldebxcontent" ng-show="1">
                        <div ng-include src="'views/app/note-background-video.html'" ></div>                
                    </div>

                    
                </ion-scroll>
            </div>
        </div>

        <!-- details (obs/diag/treatment)-->
        <div class="crighttab greentab" id="cstab2" >
            <div class="ctabbtn" ng-click="pulltab('cstab2')" style="top:45px;">
                <span class="ion-edit"></span>
            </div> 
            <div class="sidetabcontent">
                <ion-scroll direction="y" class="theroot"> 
                   
                    <div class="clr"></div><div class="clr"></div>
                    <div class="sldebxcontent" ng-show="1">
                        <div ng-include src="'views/app/consultation-note-details-video.html'" ></div>
                    </div>

                    
                </ion-scroll>
            </div>
            <div class="clr"></div>
        </div>

        <!-- view records -->
        <div class="crighttab greentab" id="cstab3" >
            <div class="ctabbtn" ng-click="pulltab('cstab3')" style="top:90px;">
                <span class="ion-folder"></span>
            </div> 
            <div class="sidetabcontent">
                <ion-scroll direction="y" class="theroot"> 
                   
                    <div class="clr"></div><div class="clr"></div>
                    <div class="sldebxcontent" ng-show="1">
                        <div ng-include src="'views/app/patients/records-view-video.html'" ></div>                
                    </div>

                    
                </ion-scroll>
            </div>
            <div class="clr"></div>
        </div>

        <!-- add family -->
        <div class="crighttab greentab hide" id="addfamilytab" >
            <div class="ctabbtn" ng-click="pulltab('addfamilytab')" style="top:135px;">
                <span class="ion-android-people"></span>
            </div> 
            <div class="sidetabcontent">
                <ion-scroll direction="y" class="theroot"> 
                   
                    <div class="clr"></div><div class="clr"></div>
                    <div class="sldebxcontent" ng-show="1">
                        <div ng-include src="'views/app/consultation-note-add-family-member.html'" ></div>                
                    </div>

                    
                </ion-scroll>
            </div>
            <div class="clr"></div>
        </div>

        <!-- Add Obervation Diagnosis -->
        <div class="crighttab greentab hide" id="obsdiagtab" >
            <div class="ctabbtn" ng-click="pulltab('obsdiagtab')" style="top:180px;">
                <span class="ion-ios-search-strong"></span>
            </div> 
            <div class="sidetabcontent">
                <ion-scroll direction="y" class="theroot"> 
                   
                    <div class="clr"></div><div class="clr"></div>
                    <div class="sldebxcontent" ng-show="1">
                        <div ng-include src="'views/app/consultation-note-observation-diagnosis-add.html'" ></div>                
                    </div>

                    
                </ion-scroll>
            </div>
            <div class="clr"></div>
        </div>

        <!-- Add Treatment -->
        <div class="crighttab greentab hide" id="addtreatmenttab" >
            <div class="ctabbtn" ng-click="pulltab('addtreatmenttab')" style="top:225px;">
                <span class="ion-clipboard"></span>
            </div> 
            <div class="sidetabcontent">
                <ion-scroll direction="y" class="theroot"> 
                   
                    <div class="clr"></div><div class="clr"></div>
                    <div class="sldebxcontent" ng-show="1">
                        <div ng-include src="'views/app/consultation-note-treatment-add-video.html'" ></div>                
                    </div>

                    
                </ion-scroll>
            </div>
            <div class="clr"></div>
        </div>

        <!-- past note (obs/diag/treatment)-->
        <div class="crighttab greentab hide" id="pastnote" >
            <div class="ctabbtn" ng-click="toggleHiddenTab('pastnote')" style="top:270px;">
                <span class="ion-edit"></span>
            </div> 
            <div class="sidetabcontent">
                <ion-scroll direction="y" class="theroot"> 
                   
                    <div class="clr"></div><div class="clr"></div>
                    <div class="sldebxcontent" ng-show="1">
                        <div ng-include src="'views/app/past-note-details-video.html'" ></div>
                    </div>

                    
                </ion-scroll>
            </div>
            <div class="clr"></div>
        </div>


    </ion-content>

    <!-- mute show/hide  -->
    <div class="sticyfooter joinfooter">
        <div class="tabs tabs-icon-top">
            <div class="tab-item muteMic"  onclick="classtoggle(this)">
                <i class="icon ion-ios-mic"></i>
                <i class="icon ion-ios-mic-off"></i>
                Mic
            </div>
            <div class="tab-item muteVideo"   onclick="classtoggle(this)">
                <i class="icon ion-ios-videocam"></i>
                Video
            </div>

        </div>
    </div>
</ion-view>

<script id="filesview.html" type="text/ng-template">
    <div class="modal">
    <header class="bar bar-header bar-positive">
    <h1 class="title">Attached Files</h1>
    <button class="button" ng-click="print()">Print</button>
    </header>
    <content has-header="true" padding="true" class="fullwh">
    <div class="mcontent">
    <div class="viewattachfile" ng-repeat="attach in cnAttachments">
    <img src="{{attachpath}}{{attach.attachment_path}}{{attach.orginial_name}}" style="border-bottom: 1px #eee solid; margin-bottom: 5px; padding: 5px 5px;"/>
    </div>
    </div>
    </content>
    <div class="bar bar-footer" style="z-index:999;"><div class="button button-positive" style="width:100%;" ng-click="modal.hide()">Cancel</div></div>
</script>
<script id="singlefileview" type="text/ng-template">
    <div class="modal">
    <header class="bar bar-header bar-positive">
    <h1 class="title">Attached Files</h1>
    <button class="button" ng-click="print()">Print</button>
    </header>
    <content has-header="true" padding="true" class="fullwh">
    <div class="mcontent">
    <!-- <iframe  type="text/html" style="width:100%; position:absolute; height:80%; top:100px;" scrolling="yes" ng-src="{{trustSrc(value)}}" allowfullscreen frameborder="0">       
    </iframe> -->
    <div class="viewattachfile">
    <img src="{{attachValue}}">
    </div>
    </div>
    </content>
    <div class="bar bar-footer" style="z-index:999;"><div class="button button-positive" style="width:100%;" ng-click="filemodal.hide()">Cancel</div></div>
</script>

<script id="knowcondition" type="text/ng-template">
    <ion-modal-view>
    <ion-header-bar class="bar app-top-bar">
    <h1 class="title">Add Quick History</h1>
    <button class="button button-clear" ng-click="modal.hide()">Cancel</button>
    </ion-header-bar>
    <ion-content>
    <ion-list>
    <ion-checkbox ng-repeat="con in conditions track by $index" ng-model="conId[con.id]" ng-click="getCondition({{con.id}},'{{con.condition}}')" ng-checked="getPreCon({{con.id}})" >{{con.condition}}</ion-checkbox>
    </ion-list>
    </ion-content>
    <div class="fixedbar">
    <div class="button btn-add"  ng-click="modal.hide()" ><i class="ion-check"></i> Submit</div>
    </div>
    </ion-modal-view>
</script>
<script id="create-Observation" type="text/ng-template">
    <ion-modal-view>
        <ion-header-bar class="bar app-top-bar">
            <h1 class="title">Write an Observation</h1>
            <div class="button button-clear" ng-click="modal.hide()"><span class="icon ion-close"></span></div>
        </ion-header-bar>
        <ion-content>
            
                <div class="item item-divider"><span>Observation </span></div> 
                <label class="item item-input listreq">
                  <textarea ng-model="data.observation" type = "text" required placeholder="Observation" rows="25" cols="300" style="resize: none;">
                    
                  </textarea>
                </label>
                <button ng-click="saveObservation()" class="button button-positive button-block">Add</button>
            
        </ion-content>
    </ion-modal-view>
</script>

<script id="create-diagnosis" type="text/ng-template">
    <ion-modal-view>
        <ion-header-bar class="bar app-top-bar">
            <h1 class="title">Write a Diagnosis</h1>
            <div class="button button-clear" ng-click="modal.hide()"><span class="icon ion-close"></span></div>
        </ion-header-bar>
        <ion-content>
            
                <div class="item item-divider"><span>Diagnosis </span></div> 
                <label class="item item-input listreq">
                  <textarea ng-model="data.diagnosis" type = "text" required placeholder="Diagnosis" rows="25" cols="300" style="resize: none;">
                    
                  </textarea>
                </label>
                <button ng-click="saveDiagnosis()" class="button button-positive button-block">Add</button>
            
        </ion-content>
    </ion-modal-view>
</script>
<script id="mealdispdetails" type="text/ng-template">
    <ion-modal-view>
    <ion-header-bar class="bar app-top-bar">
    <h1 class="modalhead txt-center">Meal Details - {{Mealday}}</h1>
    <button class="button button-clear pull-right" ng-click="submitmodal()">Cancel</button>       
    </ion-header-bar>
    <ion-content>
    <div ng-if="dietPlanDetails.length == 0"><p class="text-center">No data added</p></div>
    <div ng-repeat="diet in dietPlanDetails">
    <div class="item item-divider mt15">Meal {{$index+1}}</div>
    <div ng-repeat="meal in diet" ng-if="meal.fields.name == 'meal-1' || meal.fields.name == 'value'">
    <div class="row" >
    <div class="col" ng-if="meal.fields.field == 'Time' && meal.value != '' && meal.value != '00:00:00'">{{meal.value|timeN}}</div>
    <div class="col" ng-if="meal.fields.field != 'Time'">{{meal.value}}</div>
    </div>
    </div>
    </div>  
    </ion-content>
    </ion-modal-view>
</script>
<script id="mealdetails" type="text/ng-template">
    <ion-modal-view>
    <ion-header-bar class="bar app-top-bar">
    <h1 class="modalhead txt-center">Meal Details</h1>
    <button class="button button-clear pull-left" ng-click="submitmodal()">Cancel</button>
    <div class="buttons buttons-right pull-right"><span class="right-buttons">
    <button type="submit" ng-click="saveMeal(day)" class="button button-positive w100p brdradious0" ng-disabled="addRecordForm.$invalid" disabled="disabled"> 
    <strong>Save</strong> </button>
    </span></div>
    </ion-header-bar>
    <ion-content>
    <div ng-repeat="meal in mealDetails[day]">
    <div class="item item-divider mt15">Meal {{$index+1}}</div>
    <label class="item item-input">
    <input type="time" placeholder="Time" ng-model="mealDetails[day][$index].time"  required="">
    </label>
    <label class="item item-input">
    <textarea placeholder="Notes" name="" ng-model="mealDetails[day][$index].details" maxlength="" rows="2" cols="50"></textarea>
    </label>
    </div>  
    </ion-content>
    </ion-modal-view>
</script>